import{c as x,y as f,p as g,u as j,r as c,j as e,v as b,z as p,A as y}from"./index-BDofFu2G.js";import{m as v}from"./proxy-D7N4TsE8.js";import{L as N}from"./loader-circle-Ch-OYJ50.js";import{C as k}from"./circle-check-ChnMOUsn.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=x("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),F=()=>{const[i]=f(),s=g(),{setIsAuthenticated:d,setUser:u}=j(),[n,r]=c.useState("loading"),[o,a]=c.useState("Authenticating with GitHub..."),m=c.useRef(!1);return c.useEffect(()=>{(async()=>{if(m.current){console.log("GitHub callback already processed, skipping...");return}m.current=!0;const h=i.get("code");if(i.get("error")){r("error"),a("GitHub authentication was cancelled or failed"),setTimeout(()=>s("/login"),3e3);return}if(!h){r("error"),a("No authorization code received"),setTimeout(()=>s("/login"),3e3);return}try{console.log("Exchanging GitHub authorization code...");const t=await b.githubCallback(h);if(t.success&&t.data){const l=t.data;p(l.token),y(l.user),d(!0),u(l.user),r("success"),a("Authentication successful! Redirecting to dashboard..."),setTimeout(()=>s("/dashboard"),1500)}else throw new Error(t.error||"Authentication failed")}catch(t){console.error("GitHub callback error:",t),r("error"),a(t instanceof Error?t.message:"Failed to authenticate with GitHub"),setTimeout(()=>s("/login"),3e3)}})()},[i,s,d,u]),e.jsx("div",{className:"min-h-screen bg-background hero-grid flex items-center justify-center p-4",children:e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md text-center",children:e.jsxs("div",{className:"glass border-border/50 rounded-xl p-8 space-y-6",children:[n==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center",children:e.jsx(N,{className:"w-8 h-8 text-primary animate-spin"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Connecting to GitHub"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]})]}),n==="success"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(k,{className:"w-8 h-8 text-green-500"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-2 text-green-500",children:"Success!"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]})]}),n==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/20 flex items-center justify-center",children:e.jsx(w,{className:"w-8 h-8 text-destructive"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-2 text-destructive",children:"Authentication Failed"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]})]})]})})})};export{F as default};
